<!DOCTYPE html><html><head><title>uxcore - UXCORE UI Framework</title><link rel="stylesheet" href="//g.alicdn.com/platform/common/s/1.1/global/global.css"><link rel="stylesheet" href="/uxcore/static/uxcore.css"><link rel="stylesheet" href="/uxcore/static/github-gist.min.css"><script src="https://alinw.alicdn.com/uxcore/uxcore-lib/??es5-shim/4.1.12/es5-shim.min.js,es5-shim/4.1.12/es5-sham.min.js,react/0.14.0/react-with-addons.min.js,react/0.14.0/react-dom.min.js,rangy/1.3.0/rangy-core.min.js,jquery/1.11/jquery.min.js"></script><script src="/uxcore/static/highlight.min.js"></script><script src="/uxcore/static/uxcore.js"></script><script src="https://alinw.alicdn.com/uxcore/uxcore-lib/tinymce/4.2.5/tinymce-full.min.js"></script><script>(function(w){
	w.require = function(name){
		return w.UXCORE[name];
	}
})(window)</script></head><body><nav id="J-head" class="site-nav"><h1 class="logo">UXCORE</h1><ul class="nav-list"><li><a href="/uxcore/">首页</a></li><li><a href="/uxcore/css/base/">css</a></li><li><a href="/uxcore/components/calendar/">组件</a></li></ul></nav><div id="J-main" class="kuma-layout-full site-main"><aside class="site-aside"><ul><li><a href="/uxcore/components/calendar">Calendar</a></li><li><a href="/uxcore/components/dialog">Dialog</a></li><li><a href="/uxcore/components/select2">Select2</a></li><li><a href="/uxcore/components/pagination">Pagination</a></li><li><a href="/uxcore/components/tooltip">Tooltip</a></li><li><a href="/uxcore/components/tabs">Tabs</a></li><li class="current"><a href="/uxcore/components/grid">Grid</a></li><li><a href="/uxcore/components/form">Form</a></li><li><a href="/uxcore/components/dropdown">Dropdown</a></li><li><a href="/uxcore/components/mention">Mention</a></li><li><a href="/uxcore/components/tree">Tree</a></li><li><a href="/uxcore/components/transfer">Transfer</a></li><li><a href="/uxcore/components/popover">Popover</a></li><li><a href="/uxcore/components/hovercard">Hovercard</a></li><li><a href="/uxcore/components/uploader">Uploader</a></li><li><a href="/uxcore/components/collapse">Collapse</a></li><li><a href="/uxcore/components/progress">Progress</a></li><li><a href="/uxcore/components/steps">Steps</a></li><li><a href="/uxcore/components/menu">Menu</a></li><li><a href="/uxcore/components/button">Button</a></li></ul></aside><article class="site-content"><header class="post-title"><h1>Grid</h1><section class="meta"><span class="author"><b>author: </b>zhouquan.yezq</span><span class="github"><b>github: </b><a href="https://github.com/uxcore/uxcore-grid.git" target="_blank">Grid</a></span><span class="version"> <b>版本: </b>1.1.1</span><span class="description"><b>描述: </b>grid ui component for react</span></section></header><div id="J-markdown" class="markdown"><p><img src="https://github.com/uxcore/uxcore-grid/raw/master/demo/screenshot.png" alt=""></p>
<h2 id="best-practice">Best Practice</h2><div class="highlight"><pre><code class="javascript">
<span class="keyword">let</span> columns = [
    { dataKey: <span class="string">'id'</span>, title: <span class="string">'ID'</span>, width: <span class="number">50</span>,hidden:<span class="literal">true</span>},
    { dataKey: <span class="string">'country'</span>, title:<span class="string">'国家'</span>, width: <span class="number">200</span>,ordered:<span class="literal">true</span>},
    { dataKey: <span class="string">'city'</span>,title:<span class="string">'城市'</span>, width: <span class="number">150</span>,ordered:<span class="literal">true</span> },
    { dataKey: <span class="string">'firstName'</span>,title:<span class="string">"FristName"</span> },  
    { dataKey: <span class="string">'lastName'</span> ,title:<span class="string">"LastName"</span>},
    { dataKey: <span class="string">'email'</span>,title:<span class="string">"Email"</span>,width: <span class="number">200</span>,ordered:<span class="literal">true</span> }
],


rowSelection = {
  onSelect: <span class="function"><span class="keyword">function</span><span class="params">(record, selected, selectedRows)</span> {</span>
    console.log(record, selected, selectedRows);
  },
  onSelectAll: <span class="function"><span class="keyword">function</span><span class="params">(selected, selectedRows)</span> {</span>
    console.log(selected, selectedRows);
  }
},

renderProps={
    actionBar: {
       <span class="string">'new'</span>: <span class="function"><span class="keyword">function</span><span class="params">(type)</span>{</span> alert(type); },
       <span class="string">'import'</span>: <span class="function"><span class="keyword">function</span><span class="params">(type)</span>{</span> alert(type); },
       <span class="string">'export'</span>: <span class="function"><span class="keyword">function</span><span class="params">(type)</span>{</span> alert(type); }
    },
    fetchUrl:<span class="string">"http://localhost:3000/demo/data.json"</span>,
    jsxcolumns:columns,
    subComp:(<span class="xml"><span class="tag">&lt;<span class="title">Grid</span> {<span class="attribute">...renderSubProps</span>}  <span class="attribute">ref</span>=<span class="value">"subGrid"</span>/&gt;</span>),
    rowSelection: rowSelection
},

renderSubProps={
    jsxcolumns:columns,
    fetchUrl:"http://localhost:3000/demo/data.json",
    queryKeys:["dataKey","firstName"],
    onModifyRow: this.onModifyRow
};

<span class="tag">&lt;<span class="title">Grid</span> {<span class="attribute">...renderProps</span>} /&gt;</span></span></code></pre></div><h2 id="props">Props</h2><table>
<thead>
<tr>
<th>props name</th>
<th>defalut Value</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>width</td>
<td>1000</td>
<td>grid width</td>
</tr>
<tr>
<td>height</td>
<td>100%</td>
<td>gird height</td>
</tr>
<tr>
<td>showColumnPicker</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>showPager</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>showHeader</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>headerHeight</td>
<td>40</td>
<td></td>
</tr>
<tr>
<td>showMask</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>showSearch</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>pageSize</td>
<td>10</td>
<td></td>
</tr>
<tr>
<td>queryKeys</td>
<td>[]</td>
<td>in subComp mode, it tells parent what datas need to pass to child, like a filter, the parent will pass all his data to his child if queryKey is undefined</td>
</tr>
<tr>
<td>jsxcolumns</td>
<td>null</td>
<td>columns config</td>
</tr>
<tr>
<td>jsxdata</td>
<td>null</td>
<td>grid data</td>
</tr>
<tr>
<td>fetchUrl</td>
<td>&quot;&quot;</td>
<td>dynamic get data from server</td>
</tr>
<tr>
<td>fetchParams</td>
<td>{}</td>
<td>in form-grid mode, form will pass fetch params for grid</td>
</tr>
<tr>
<td>actionBar</td>
<td>null</td>
<td>actionBar configuration</td>
</tr>
<tr>
<td>beforeFetch</td>
<td>noop</td>
<td>invoked before the grid fetch data, two params <code>data</code> and <code>from</code>, <code>data</code> is the one which will be passed as querys in ajax, <code>from</code> means where the fetch is invoked containing 3 preset values <code>search</code>,<code>order</code> &amp; <code>pagination</code>.return the data you really want ajax to send.</td>
</tr>
<tr>
<td>processData</td>
<td>noop</td>
<td>sometimes the data fetched via ajax is not the one which you or grid want, you can use this method to change the data and return it to grid. the param is the data which grid is ready to use for rendering</td>
</tr>
</tbody>
</table>
<h3 id="props-you-should-not-define-by-yourself">Props you should not define by yourself</h3><blockquote>
<p>Parent will pass this props to his child  </p>
</blockquote>
<table>
<thead>
<tr>
<th>props name</th>
<th>defalut Value</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>passedData</td>
<td>null</td>
<td>Data passed from parent</td>
</tr>
</tbody>
</table>
<h3 id="columns">Columns</h3><table>
<thead>
<tr>
<th>Key Name</th>
<th>require</th>
<th>value type</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>dataKey</td>
<td>yes</td>
<td>string</td>
<td>use key</td>
</tr>
<tr>
<td>title</td>
<td>yes</td>
<td>string</td>
<td>column display name</td>
</tr>
<tr>
<td>width</td>
<td>yes</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td>hidden</td>
<td>optional</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>order</td>
<td>optional</td>
<td>boolean</td>
<td>need order feature or not</td>
</tr>
<tr>
<td>type</td>
<td>optional</td>
<td>string</td>
<td>containing &#39;money&#39;, &#39;card&#39;, &#39;cnmobile&#39; &amp; &#39;action&#39;</td>
</tr>
<tr>
<td>items</td>
<td>yes</td>
<td>array</td>
<td>when type ==&#39;action&#39;, we need this attr</td>
</tr>
<tr>
<td><a href="https://github.com/uxcore/uxcore-grid/issues/30">render</a></td>
<td>optional</td>
<td>function</td>
<td>for custom cell</td>
</tr>
<tr>
<td><a href="https://github.com/uxcore/uxcore-grid/issues/30">beforeRender</a></td>
<td>optional</td>
<td>function</td>
<td>for custom cell data</td>
</tr>
<tr>
<td>delimiter</td>
<td>optional</td>
<td>string</td>
<td>delimiter used in type &#39;money&#39;, &#39;card&#39;, &#39;cnmobile&#39; formating</td>
</tr>
</tbody>
</table>
<pre>
let columns = [
            { dataKey: &#39;id&#39;, title: &#39;ID&#39;, width: 50,hidden:true},
            { dataKey: &#39;country&#39;, title:&#39;国家&#39;, width: 200,ordered:true},
            { dataKey: &#39;city&#39;,title:&#39;城市&#39;, width: 150,ordered:true },
            { dataKey: &#39;firstName&#39;,title:&quot;FristName&quot; },  
            { dataKey: &#39;lastName&#39; ,title:&quot;LastName&quot;, beforeRender: function(rowData){
                //do logic , then return cell data
                return &#39;abc&#39;;
            }},
            { dataKey: &#39;email&#39;,title:&quot;Email&quot;,width: 200,ordered:true },
            { dataKey: &#39;action1&#39;, title:&#39;操作1&#39;, width:100, type:&quot;action&quot;,actions:{
                &quot;编辑&quot;: function(rowData) {
                    me.refs.grid.toggleSubComp(rowData);
                },
                &quot;删除&quot;: function(rowData) {
                    me.refs.grid.delRow(rowData);
                }
             }},
            { dataKey: &#39;action&#39;, title:&#39;链接&#39;, width:100,render: function(cellData,rowData){
               return &lt;div&gt;&lt;a href=&quot;#&quot;&gt;{rowData.email}&lt;/a&gt;&lt;/div&gt;
              }
            }
     ]</pre><h2 id="rules">Rules</h2><ul>
<li><p>return data format <a href="http://gitlab.alibaba-inc.com/alinw/yosemite/issues/18">here</a></p>
<pre>{
&quot;content&quot;:{
    &quot;datas&quot;:[
        {
            &quot;id&quot;:&#39;1&#39;
            &quot;grade&quot;:&quot;grade1&quot;,
            &quot;email&quot;:&quot;email1&quot;,
            &quot;firstName&quot;:&quot;firstName1&quot;,
            &quot;lastName&quot;:&quot;lastName1&quot;,
            &quot;birthDate&quot;:&quot;birthDate1&quot;,
            &quot;country&quot;:&quot;country1&quot;,
            &quot;city&quot;:&quot;city1&quot;
        }
        ...

    ],
    &quot;currentPage&quot;:1,
    &quot;totalCount&quot;:30
},
&quot;success&quot;:true,
&quot;errorCode&quot;:&quot;&quot;,
&quot;errorMsg&quot;:&quot;&quot;
}</pre></li>
</ul>
<h2 id="api">API</h2><ul>
<li>fetchData(from): call this method when you want the grid to fetch Data via ajax again.<ul>
<li>@param from {string} optional: the param will be passed to props.beforeFetch, use it when you want to do something different by judging this param.</li>
</ul>
</li>
<li>getData()</li>
<li>addEmptyRow()</li>
<li>addRow(rowData)</li>
<li>updataRow(rowData)</li>
<li>delRow(rowData)</li>
<li>toggleSubComp(rowData)<ul>
<li>show or hide sub comp</li>
</ul>
</li>
</ul>
</div><h2 class="site-demos"> <i class="kuma-icon kuma-icon-graph"></i>组件演示</h2><div id="code-box-components-grid-demo-basic" class="code-box"><div class="code-box-meta"><div class="code-box-title"><i class="kuma-icon kuma-icon-tag"></i><em>基本</em></div></div><div class="code-box-demo"><div id="components-grid-demo-basic"></div></div><div class="code-box-markdown markdown"><script>(function(){'use strict';

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Grid = require('uxcore-grid');

var Demo = (function (_React$Component) {
  _inherits(Demo, _React$Component);

  function Demo(props) {
    _classCallCheck(this, Demo);

    _get(Object.getPrototypeOf(Demo.prototype), 'constructor', this).call(this, props);
    this.state = {
      data: this.props.data
    };
  }

  _createClass(Demo, [{
    key: 'onModifyRow',
    value: function onModifyRow(value, dataKey, record) {
      //doValidate
      //debugger;
      //return false;
      return true;
    }
  }, {
    key: 'render',
    value: function render() {
      console.log("demo render");
      var me = this;
      // 通过 rowSelection 对象表明需要行选择
      var rowSelection = {
        onSelect: function onSelect(record, selected, selectedRows) {
          console.log(record, selected, selectedRows);
        },
        onSelectAll: function onSelectAll(selected, selectedRows) {
          console.log(selected, selectedRows);
        }
      };

      var doAction = function doAction(rowData, e) {
        var el = $(e.target);
        if (el.hasClass('action')) {
          if (el.data('type') == 'edit') {
            console.info(rowData, el.data('type'));
          } else if (el.data('type') == 'del') {
            console.info(rowData, el.data('type'));
          }
        }
      };
      // title, width, type, hidden,dataKey
      var columns = [{ dataKey: 'id', title: 'ID', width: 50, hidden: true }, { dataKey: 'country', title: '国家', width: 200, ordered: true }, { dataKey: 'city', title: '城市', width: 150, ordered: true }, { dataKey: 'firstName', title: "FristName" }, { dataKey: 'lastName', title: "LastName" }, { dataKey: 'email', title: "Email", width: 200, ordered: true }, { dataKey: 'action1', title: '操作1', width: 100, type: "action", items: [{ title: '编辑', type: "inlineEdit", cb: function cb(rowData) {
            console.info(rowData);
          } }, { title: '删除', type: "del", cb: function cb(rowData) {
            console.info(rowData);
          } }] }, { dataKey: 'action', title: '链接', width: 100, render: function render(rowData) {
          return React.createElement(
            'div',
            null,
            React.createElement(
              'a',
              { href: '#' },
              rowData.email
            )
          );
        }
      }];

      var fetchUrl = '../../static/data.json';
      var renderSubProps = {
        showHeader: false,
        showPager: false,
        //showMask:false,
        jsxcolumns: columns,
        fetchUrl: fetchUrl,
        queryKeys: ["dataKey", "firstName"],
        onModifyRow: this.onModifyRow
      };

      var renderProps = {
        height: 400,
        actionBar: {
          'new': function _new() {
            alert('new');
          },
          'import': function _import() {
            alert('import');
          },
          'export': function _export() {
            alert('export');
          },
          'search': true,
          'subComp': '' //TODO
        },
        actionColumn: {
          'edit': function edit() {},
          'del': function del() {}
        },
        fetchParams: '',
        fetchUrl: fetchUrl,
        jsxcolumns: columns,
        subComp: React.createElement(Grid, _extends({}, renderSubProps, { ref: 'subGrid' })),
        //onModifyRow: this.onModifyRow,
        rowSelection: rowSelection
      };
      return React.createElement(Grid, _extends({}, renderProps, { ref: 'grid' }));
    }
  }]);

  return Demo;
})(React.Component);

;

ReactDOM.render(React.createElement(Demo, null), document.getElementById('components-grid-demo-basic'));})()</script><div class="highlight"><pre><code class="javascript"><span class="keyword">let</span> Grid = require(<span class="string">'uxcore-grid'</span>);

class Demo extends React.Component {

    constructor(props) {
        super(props);
        <span class="keyword">this</span>.state = {
           data:<span class="keyword">this</span>.props.data
        }
    }

    onModifyRow(value,dataKey,record) {
        <span class="comment">//doValidate</span>
        <span class="comment">//debugger;</span>
        <span class="comment">//return false;</span>
        <span class="keyword">return</span> <span class="literal">true</span>;
    }

      render () {
        console.log(<span class="string">"demo render"</span>);
        <span class="keyword">let</span> me=<span class="keyword">this</span>;
        <span class="comment">// 通过 rowSelection 对象表明需要行选择</span>
        <span class="keyword">let</span> rowSelection = {
          onSelect: <span class="function"><span class="keyword">function</span><span class="params">(record, selected, selectedRows)</span> {</span>
            console.log(record, selected, selectedRows);
          },
          onSelectAll: <span class="function"><span class="keyword">function</span><span class="params">(selected, selectedRows)</span> {</span>
            console.log(selected, selectedRows);
          }
        };

        <span class="keyword">let</span> doAction= <span class="function"><span class="keyword">function</span><span class="params">(rowData,e)</span> {</span>
            <span class="keyword">let</span> el=$(e.target);
            <span class="keyword">if</span>(el.hasClass(<span class="string">'action'</span>)) {
               <span class="keyword">if</span>( el.data(<span class="string">'type'</span>) ==<span class="string">'edit'</span>) {
                  console.info(rowData,el.data(<span class="string">'type'</span>));
               }<span class="keyword">else</span> <span class="keyword">if</span>(el.data(<span class="string">'type'</span>) ==<span class="string">'del'</span>) {
                 console.info(rowData,el.data(<span class="string">'type'</span>));
               }
            }
        }
        <span class="comment">// title, width, type, hidden,dataKey</span>
        <span class="keyword">let</span> columns = [
            { dataKey: <span class="string">'id'</span>, title: <span class="string">'ID'</span>, width: <span class="number">50</span>,hidden:<span class="literal">true</span>},
            { dataKey: <span class="string">'country'</span>, title:<span class="string">'国家'</span>, width: <span class="number">200</span>,ordered:<span class="literal">true</span>},
            { dataKey: <span class="string">'city'</span>,title:<span class="string">'城市'</span>, width: <span class="number">150</span>,ordered:<span class="literal">true</span> },
            { dataKey: <span class="string">'firstName'</span>,title:<span class="string">"FristName"</span> },  
            { dataKey: <span class="string">'lastName'</span> ,title:<span class="string">"LastName"</span>},
            { dataKey: <span class="string">'email'</span>,title:<span class="string">"Email"</span>,width: <span class="number">200</span>,ordered:<span class="literal">true</span> },
            { dataKey: <span class="string">'action1'</span>, title:<span class="string">'操作1'</span>, width:<span class="number">100</span>, type:<span class="string">"action"</span>,items:[
              {title:<span class="string">'编辑'</span>, type:<span class="string">"inlineEdit"</span>, cb: <span class="function"><span class="keyword">function</span><span class="params">(rowData)</span>{</span>console.info(rowData)}},
              {title:<span class="string">'删除'</span>, type:<span class="string">"del"</span>, cb: <span class="function"><span class="keyword">function</span><span class="params">(rowData)</span>{</span>console.info(rowData)}}
            ]},
            { dataKey: <span class="string">'action'</span>, title:<span class="string">'链接'</span>, width:<span class="number">100</span>,render: <span class="function"><span class="keyword">function</span><span class="params">(rowData)</span>{</span>
               <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>{rowData.email}<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
              }
            }
        ]

        let fetchUrl = '../../static/data.json';
        let renderSubProps={
            showHeader:false,
            showPager:false,
            //showMask:false,
            jsxcolumns:columns,
            fetchUrl: fetchUrl,
            queryKeys:["dataKey","firstName"],
            onModifyRow: this.onModifyRow
        };

        let renderProps={
            height: 400,
            actionBar: {
               'new': function(){ alert('new'); },
               'import': function(){ alert('import'); },
               'export': function(){ alert('export'); },
               'search': true,
               'subComp':'' //TODO
            },
            actionColumn: {
               'edit': function() {},
               'del': function() {}
            },
            fetchParams:'',
            fetchUrl: fetchUrl,
            jsxcolumns:columns,
            subComp:(<span class="tag">&lt;<span class="title">Grid</span> {<span class="attribute">...renderSubProps</span>}  <span class="attribute">ref</span>=<span class="value">"subGrid"</span>/&gt;</span>),
            //onModifyRow: this.onModifyRow,
            rowSelection: rowSelection
        };
        return (<span class="tag">&lt;<span class="title">Grid</span> {<span class="attribute">...renderProps</span>}  <span class="attribute">ref</span>=<span class="value">"grid"</span>/&gt;</span>);
      }
};

ReactDOM.render(<span class="tag">&lt;<span class="title">Demo</span> /&gt;</span>, document.getElementById('components-grid-demo-basic'))</span></code></pre></div></div></div></article></div></body></html>